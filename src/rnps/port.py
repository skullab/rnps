# ----------------------------------------------------------------------------------------
# RNPS aka Rapid Network Port Scan
# Copyright (C) 2022 Ivan Maruca <ivan>DOT<maruca>AT<gmail>DOT<com>
# 
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as
# published by the Free Software Foundation, either version 3 of the
# License, or (at your option) any later version.
# 
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.
# 
# You should have received a copy of the GNU Affero General Public License
# along with this program.  If not, see https://www.gnu.org/licenses/agpl-3.0.en.html
# ----------------------------------------------------------------------------------------

class Port:
    TCP = 'TCP'
    UDP = 'UDP'
    ALL_RANGE = range(0,65536)
    RESERVED_RANGE = range(0,1024)
    REGISTERED_RANGE = range(1024,49152)
    FREE_RANGE = range(49152,65536)
    def __init__(self,_range=range(80,81),_type=None) -> None:
        self.range = _range
        self.type = self.TCP if _type is None else _type

class PortService:
    LIST = {
        "0":"ERVED",
        "1":"MUX",
        "2":"PRESSNET",
        "3":"PRESSNET",
        "5":"OTE JOB ENTRY",
        "7":"O PROTOCOL",
        "9":"CARD PROTOCOL OR WAKE-ON-LAN",
        "11":"SYSTAT",
        "13":"DAYTIME PROTOCOL",
        "15":"NETSTAT",
        "17":"QOTD",
        "18":"MESSAGE SEND PROTOCOL",
        "19":"CHARGEN",
        "20":"FTP",
        "21":"FTP",
        "22":"SSH",
        "23":"TELNET ",
        "25":"SMTP",
        "27":"NSW-FE",
        "28":"SYNC ENCRYPTED PORT",
        "29":"MSG-ICP",
        "31":"MSG-AUTH",
        "33":"DSP",
        "37":"TIME PROTOCOL",
        "38":"RAP (ROUTE ACCESS PROTOCOL)",
        "38":"RLP (RESOURCE LOCATION PROTOCOL)",
        "41":"GRAPHICS",
        "42":"HOST NAME SERVER PROTOCOL",
        "43":"WHOIS",
        "44":"MPM-FLAGS",
        "45":"MPM (MESSAGE PROCESSING MODULE)",
        "46":"MPM-SND (MPM)",
        "47":"UNKNOW",
        "48":"AUDITD",
        "49":"TACACS",
        "50":"RE-MAIL-CK (REMOTE MAIL CHECKING PROTOCOL)",
        "52":"XNS (XEROX TIME PROTOCOL)",
        "53":"DNS",
        "54":"XNS (XEROX NAME SERVER)",
        "55":"ISI-GL (ISI GRAPHICS LANGUAGE)",
        "56":"XNS (XEROX AUTH PROTOCOL)",
        "58":"XEROX NETWORK SYSTEMS (XNS) MAIL",
        "62":"ACAS (ACA SERVICES)",
        "63":"WHOISPP",
        "64":"COVIA",
        "65":"TACACS-DS (TACACS-DATABASE SERVICE)",
        "66":"SQL-NET (ORACLE SQL*NET)",
        "67":"BOOTP/DHCP",
        "68":"BOOTP/DHCP",
        "69":"TFTP",
        "70":"GOPHER PROTOCOL",
        "71":"NETRJS PROTOCOL",
        "72":"NETRJS PROTOCOL",
        "73":"NETRJS PROTOCOL",
        "74":"NETRJS PROTOCOL",
        "76":"DEOS (DISTRIBUTED EXTERNAL OBJECT STORE)",
        "78":"VETTCP",
        "79":"FINGER PROTOCOL",
        "80":"HTTP",
        "81":"TORPARK ONION ROUTING",
        "82":"XFER (XFER UTILITY)",
        "82":"TORPARK CONTROL",
        "83":"MIT-ML-DEV (MIT ML DEVICE)",
        "84":"CTF (COMMON TRACE FACILITY)",
        "85":"MIT-ML-DEV (MIT ML DEVICE)",
        "86":"MFCOBOL (MICRO FOCUS COBOL)",
        "88":"KERBEROS AUTHENTICATION SYSTEM",
        "89":"SU-MIT-TG (SU/MIT TELNET GATEWAY)",
        "90":"DNSIX (DNSIX SECURITY ATTRIBUTE TOKEN MAP)",
        "90":"POINTCAST (DOTCOM)",
        "91":"MIT-DOV (MIT DOVER SPOOLER)",
        "92":"NPP (NETWORK PRINTING PROTOCOL)",
        "93":"DCP (DEVICE CONTROL PROTOCOL)",
        "94":"OBJCALL (TIVOLI OBJECT DISPATCHER)",
        "95":"SUPDUP (TERMINAL-INDEPENDENT REMOTE LOGIN)",
        "96":"DIXIE (DIXIE PROTOCOL SPECIFICATION)",
        "97":"SWIFT-RVF (SWIFT REMOTE VIRTUAL FILE PROTOCOL)",
        "98":"TACNEWS (TAC NEWS)",
        "99":"METAGRAM (METAGRAM RELAY)",
        "101":"NIC HOST NAME",
        "102":"TSAP (ISO TRANSPORT SERVICE ACCESS POINT)",
        "104":"DICOM (DIGITAL IMAGING AND COMMUNICATIONS IN MEDICINE)",
        "105":"CCSO NAMESERVER",
        "106":"MACOS (MACOS PASSWORD SERVER)",
        "107":"RTELNET (REMOTE USER TELNET SERVICE)",
        "108":"SNA (IBM SYSTEMS NETWORK ARCHITECTURE GATEWAY ACCESS SERVER)",
        "109":"POP2",
        "110":"POP3",
        "111":"SUN RPC",
        "113":"IDENT AUTHENTICATION SERVICE",
        "115":"SIMPLE FILE TRANSFER PROTOCOL",
        "117":"UUCP MAPPING PROJECT (PATH SERVICE)",
        "118":"SQL",
        "119":"NNTP (NETWORK NEWS TRANSFER PROTOCOL)",
        "123":"NTP (NETWORK TIME PROTOCOL)",
        "126":" UNISYS/NXEDIT",
        "135":"MICROSOFT EPMAP (END POINT MAPPER)",
        "137":"NETBIOS (NAME SERVICE)",
        "138":"NETBIOS (DATAGRAM SERVICE)",
        "139":"NETBIOS (SESSION SERVICE)",
        "143":"IMAP",
        "151":"HEMS",
        "152":"BFTP",
        "153":"SGMP (SIMPLE GATEWAY MONITORING PROTOCOL)",
        "156":"SQL",
        "158":"DMSP/PCMAIL (DISTRIBUTED MAIL SYSTEM PROTOCOL)",
        "161":"SNMP (SIMPLE NETWORK MANAGEMENT PROTOCOL)",
        "162":"SNMPTRAP (SIMPLE NETWORK MANAGEMENT PROTOCOL TRAP)",
        "165":"XEROX",
        "169":"SEND",
        "170":"NETWORK POSTSCRIPT PRINT SERVER",
        "177":"XDMCP (X DISPLAY MANAGER CONTROL PROTOCOL)",
        "179":"BGP (BORDER GATEWAY PROTOCOL)",
        "180":"RIS",
        "194":"IRC",
        "199":"SMUX (SNMP UNIX MULTIPLEXER)",
        "201":"APPLETALK ROUTING MAINTENANCE",
        "209":"QUICK MAIL TRANSFER PROTOCOL",
        "210":"ANSI Z39.50",
        "213":"IPX (INTERNETWORK PACKET EXCHANGE)",
        "218":"MPP (MESSAGE POSTING PROTOCOL)",
        "220":"IMAP3",
        "259":"ESRO (EFFICIENT SHORT REMOTE OPERATIONS)",
        "262":"ARCISDMS",
        "264":"BGMP (BORDER GATEWAY MULTICAST PROTOCOL)",
        "280":"HTTP-MGMT",
        "300":"THINLINC WEB ACCESS",
        "308":"NOVASTOR ONLINE BACKUP",
        "311":"MACOS SERVER ADMIN (OFFICIALLY APPLESHARE IP WEB ADMINISTRATION)",
        "312":"MACOS XSAN ADMINISTRATION",
        "318":"TSP PKIX (TIME STAMP PROTOCOL)",
        "319":"PTP (PRECISION TIME PROTOCOL EVENT MESSAGES)",
        "320":"PTP (PRECISION TIME PROTOCOL GENERAL MESSAGES)",
        "350":"MATIP TYPE A",
        "351":"MATIP TYPE B",
        "356":"CLOANTO-NET-1",
        "366":"ODMR (ON-DEMAND MAIL RELAY)",
        "369":"RPC2PORTMAP",
        "370":"CODAAUTH2 OR SECURECAST1",
        "371":"CLEARCASE ALBD",
        "376":"AMIGA ENVOY (NETWORK INQUIRY PROTOCOL)",
        "383":"HP DATA ALARM MANAGER",
        "384":"A REMOTE NETWORK SERVER SYSTEM",
        "387":"AURP (APPLETALK UPDATE-BASED ROUTING PROTOCOL)",
        "388":"UNIDATA (LDM NEAR REAL-TIME DATA DISTRIBUTION PROTOCOL)",
        "389":"LDAP",
        "399":"DECNET+",
        "401":"UPS (UNINTERRUPTIBLE POWER SUPPLY)",
        "427":"SLP (SERVICE LOCATION PROTOCOL)",
        "433":"NNTP (NETWORK NEWS TRANSFER PROTOCOL)",
        "434":"MOBILE IP AGENT (RFC 5944)",
        "443":"HTTPS",
        "444":"SNPP (SIMPLE NETWORK PAGING PROTOCOL)",
        "445":"MICROSOFT-DS",
        "464":"KERBEROS CHANGE/SET PASSWORD",
        "465":"SMTPS",
        "475":"TCPNETHASPSRV (ALADDIN KNOWLEDGE SYSTEMS HASP SERVICES)",
        "476":"CENTRO SOFTWARE ERP PORTS",
        "477":"CENTRO SOFTWARE ERP PORTS",
        "478":"CENTRO SOFTWARE ERP PORTS",
        "479":"CENTRO SOFTWARE ERP PORTS",
        "480":"CENTRO SOFTWARE ERP PORTS",
        "481":"CENTRO SOFTWARE ERP PORTS",
        "482":"CENTRO SOFTWARE ERP PORTS",
        "483":"CENTRO SOFTWARE ERP PORTS",
        "484":"CENTRO SOFTWARE ERP PORTS",
        "485":"CENTRO SOFTWARE ERP PORTS",
        "486":"CENTRO SOFTWARE ERP PORTS",
        "487":"CENTRO SOFTWARE ERP PORTS",
        "488":"CENTRO SOFTWARE ERP PORTS",
        "489":"CENTRO SOFTWARE ERP PORTS",
        "490":"CENTRO SOFTWARE ERP PORTS",
        "491":"GO-GLOBAL REMOTE ACCESS AND APPLICATION PUBLISHING SOFTWARE",
        "497":"RETROSPECT",
        "500":"ISAKMP/IKE (INTERNET SECURITY ASSOCIATION AND KEY MANAGEMENT PROTOCOL)",
        "502":"MODBUS PROTOCOL",
        "504":"CITADEL",
        "510":"FCP (FIRSTCLASS PROTOCOL)",
        "512":"REXEC OR COMSAT",
        "513":"RLOGIN OR WHO",
        "514":"SYSLOG/REMOTE SHELL",
        "515":"LPD (LINE PRINTER DAEMON)",
        "517":"TALK",
        "518":"NTALK",
        "520":"EFS OR RIP",
        "521":"RIPNG (ROUTING INFORMATION PROTOCOL NEXT GENERATION)",
        "524":"NCP (NETWARE CORE PROTOCOL)",
        "525":"TIMED (TIMESERVER)",
        "530":"RPC (REMOTE PROCEDURE CALL)",
        "532":"NETNEWS",
        "533":"NETWALL (FOR EMERGENCY BROADCASTS)",
        "540":"UUCP (UNIX-TO-UNIX COPY PROTOCOL)",
        "542":"COMMERCE (COMMERCE APPLICATIONS)",
        "543":"KLOGIN (KERBEROS LOGIN)",
        "544":"KSHELL (KERBEROS REMOTE SHELL)",
        "546":"DHCPV6 CLIENT",
        "547":"DHCPV6 SERVER",
        "548":"AFP (APPLE FILING PROTOCOL)",
        "550":"NEW-RWHO/NEW-WHO",
        "554":"RTSP (REAL TIME STREAMING PROTOCOL)",
        "556":"REMOTEFS/RFS/RFS_SERVER",
        "560":"RMONITOR (REMOTE MONITOR)",
        "561":"MONITOR",
        "563":"NNTPS",
        "564":"9P (PLAN 9)",
        "585":"IMAPS",
        "587":"SMTP",
        "591":"FILEMAKER 6.0 WEB SHARING",
        "593":"HTTP RPC EP MAP",
        "601":"RELIABLE SYSLOG SERVICE",
        "604":"TUNNEL PROFILE",
        "623":"ASF-RMCP",
        "625":"ODPROXY (OPEN DIRECTORY PROXY)",
        "631":"IPP OR CUPS (COMMON UNIX PRINTING SYSTEM)",
        "635":"RLZ DBASE",
        "636":"LDAPS (LIGHTWEIGHT DIRECTORY ACCESS PROTOCOL)",
        "639":"MSDP (MULTICAST SOURCE DISCOVERY PROTOCOL)",
        "641":"CONTROL/LISTENING",
        "643":"SANITY",
        "646":"LDP",
        "647":"DHCP FAILOVER PROTOCOL",
        "648":"RRP (REGISTRY REGISTRAR PROTOCOL)",
        "651":"IEEE-MMS",
        "653":"DATA",
        "654":"MMS/MMP (MEDIA MANAGEMENT SYSTEM/PROTOCOL)",
        "655":"TINC VPN DAEMON",
        "657":"IBM RMC (REMOTE MONITORING AND CONTROL)",
        "660":"MACOS SERVER ADMINISTRATION",
        "666":"DOOM",
        "674":"ACAP (APPLICATION CONFIGURATION ACCESS PROTOCOL)",
        "688":"REALM-RUSD",
        "690":"VATP (VELNEO APPLICATION TRANSFER PROTOCOL)",
        "691":"MS EXCHANGE ROUTING",
        "694":"LINUX-HA HIGH-AVAILABILITY HEARTBEAT",
        "695":"IEEE-MMS-SSL (IEEE MEDIA MANAGEMENT SYSTEM OVER SSL)",
        "698":"OLSR (OPTIMIZED LINK STATE ROUTING)",
        "700":"EPP (EXTENSIBLE PROVISIONING PROTOCOL)",
        "701":"LMP (LINK MANAGEMENT PROTOCOL)",
        "702":"IRIS",
        "706":"SILC (SECURE INTERNET LIVE CONFERENCING)",
        "711":"CISCO TAG DISTRIBUTION PROTOCOL",
        "712":"TBRPF RFC 3684",
        "749":"KERBEROS ADMINISTRATION",
        "750":"KERBEROS-IV",
        "751":"KERBEROS_MASTER/KERBEROS AUTHENTICATION",
        "752":"KPASSWD (KERBEROS PASSWORD SERVER)",
        "753":"RRH OR USERREG_SERVER (KERBEROS USERREG SERVER)",
        "754":"TELL SEND OR KRB5_PROP (KERBEROS V5 SLAVE PROPAGATION)",
        "760":"KRBUPDATE (KERBEROS REGISTRATION)",
        "782":"CONSERVER (SERIAL-CONSOLE MANAGEMENT SERVER)",
        "783":"SPAMASSASSIN",
        "800":"MDBS-DAEMON",
        "802":"MODBUS/TCP SECURITY",
        "808":"MICROSOFT .NET TCP PORT SHARING SERVICE",
        "829":"CERTIFICATE MANAGEMENT PROTOCOL",
        "830":"NETCONF OVER SSH",
        "831":"NETCONF OVER BEEP",
        "832":"NETCONF FOR SOAP OVER HTTPS",
        "833":"NETCONF FOR SOAP OVER BEEP",
        "843":"ADOBE FLASH",
        "847":"DHCP FAILOVER PROTOCOL",
        "848":"GDOI (GROUP DOMAIN OF INTERPRETATION PROTOCOL)",
        "853":"DNS OVER TLS",
        "860":"ISCSI (RFC 3720)",
        "861":"OWAMP CONTROL (RFC 4656)",
        "862":"TWAMP CONTROL (RFC 5357)",
        "873":"RSYNC (FILE SYNCHRONIZATION PROTOCOL)",
        "888":"CDDBP/CDDB",
        "897":"BROCADE SMI-S RPC",
        "898":"BROCADE SMI-S RPC SSL",
        "902":"VMWARE ESXI",
        "903":"VMWARE ESXI",
        "953":"RNDC (BIND REMOTE NAME DAEMON CONTROL)",
        "981":"VPN-1 FIREWALL",
        "987":"SONY PLAYSTATION WAKE ON LAN / MICROSOFT REMOTE WEB WORKPLACE",
        "988":"LUSTRE (FILE SYSTEM)",
        "989":"FTPS",
        "990":"FTPS",
        "991":"NAS (NETNEWS ADMINISTRATION SYSTEM)",
        "992":"TELNET PROTOCOL OVER TLS/SSL",
        "993":"IMAPS",
        "994":"IRCS",
        "995":"POP3S",
        "1010":"THINLINC (WEB-BASED ADMINISTRATION INTERFACE)",
        "1023":"NFS (Z/OS NETWORK FILE SYSTEM)",
    }

    @staticmethod
    def getServiceName(port):
        port = str(port)
        service = PortService.LIST[port] if port in PortService.LIST else "UNKNOW"
        return service